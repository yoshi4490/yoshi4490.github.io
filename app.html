<!doctype html>
<html lang="ja"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>çµŒç†ãƒ©ãƒœãƒ™ãƒ¼ã‚¹ï½œå­¦ç¿’ã‚¢ãƒ—ãƒª</title>
<link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
<style>
:root{--bg:#f7fbff;--ink:#0f172a;--muted:#64748b;--panel:#ffffff;--border:#e2e8f0;--brand:#3bb3df;--brand2:#12b4a6;--ok:#10b981;--ng:#ef4444;--shadow:0 10px 30px rgba(17,24,39,.08);--gold:#f7b500;--silver:#bfc5d1;--bronze:#c08457}
*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,'Noto Sans JP','Hiragino Kaku Gothic ProN','Yu Gothic',Meiryo,sans-serif;background:linear-gradient(180deg,#f7fbff 0%,#fbffff 100%);color:var(--ink)}
header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#ffffff,rgba(255,255,255,.85));backdrop-filter: blur(6px);border-bottom:1px solid var(--border)}
.wrap{max-width:1100px;margin:0 auto;padding:14px 18px}
.brand{display:flex;gap:10px;align-items:center;font-weight:800}
.logo{width:24px;height:24px}
.progress{height:10px;background:#e5f3ff;border-radius:999px;overflow:hidden}.bar{height:100%;width:0%;background:linear-gradient(90deg,var(--brand2),#3bb3df);transition: width .3s ease}
.pill{display:inline-block;font-size:12px;padding:2px 10px;border-radius:999px;background:#e6f7f5;color:#0a5e57;border:1px solid #d9f2ef}
.btn{padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;cursor:pointer;font-size:14px}
.btn.primary{background:var(--brand2);color:#fff;border:none}
.muted{color:var(--muted)}.card{background:var(--panel);border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow)}
.card .head{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.card .body{padding:16px}.grid{display:grid;gap:12px}.two{grid-template-columns:1fr 1fr}.scene{display:grid;grid-template-columns:1.2fr 1fr;gap:16px;align-items:center}.scene svg{width:100%;height:auto}
label{display:block;font-size:12px;color:#334155;margin-bottom:6px}input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;font-size:14px;background:#fff}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.ok{color:var(--ok);font-weight:600}.ng{color:var(--ng);font-weight:600}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,'Courier New',monospace}
.top{display:grid;grid-template-columns:1.1fr 1fr;gap:16px;margin-top:16px}.center{text-align:center}.navdays{display:flex;gap:8px;flex-wrap:wrap}
.footer{color:#9aa3af;font-size:12px;text-align:center;margin:16px 0}.modal{position:fixed;inset:0;background:rgba(15,23,42,.35);display:none;align-items:center;justify-content:center;z-index:40}
.modal .box{background:#fff;border-radius:20px;padding:22px;width:min(560px,92vw);box-shadow:var(--shadow);text-align:center;transform:scale(.9);opacity:.6;animation:pop .35s forwards}
@keyframes pop{to{transform:scale(1);opacity:1}}.medal{width:140px;height:140px;margin:0 auto 10px;border-radius:50%;position:relative;transform:scale(.8) rotate(-10deg);animation:medalIn .5s .15s forwards}
@keyframes medalIn{to{transform:scale(1) rotate(0deg)}}.medal::after{content:'';position:absolute;inset:16px;border-radius:50%;background:#fff}#confetti{position:fixed;inset:0;pointer-events:none;z-index:45}
.diagram{background:#f8feff;border:1px dashed #cfeff7;border-radius:14px;padding:12px}.arrow{stroke:#12b4a6;stroke-width:2;fill:none;stroke-linecap:round;stroke-dasharray:6 6;animation:dash 1.6s linear infinite}@keyframes dash{to{stroke-dashoffset:-100}}
.toast{position:fixed;right:16px;bottom:16px;background:#0f172a;color:#fff;padding:12px 14px;border-radius:12px;box-shadow:var(--shadow);opacity:.95;display:none;z-index:50}
</style></head>
<body>
<header><div class="wrap" style="display:flex;align-items:center;justify-content:space-between;">
  <div class="brand"><img class="logo" src="assets/logo.svg" alt=""><span>å­¦ç¿’ã‚¢ãƒ—ãƒª</span> <span class="pill">Î²</span></div>
  <div class="row">
    <a class="btn" href="index.html">ãƒ›ãƒ¼ãƒ ã¸</a>
    <div class="progress" style="width:220px;"><div id="bar" class="bar"></div></div>
    <div class="mono" id="pct" style="min-width:48px;text-align:right;">0%</div>
    <div class="mono" id="remain" style="min-width:90px;text-align:right;color:#64748b;">æ®‹ã‚Š 10æ—¥</div>
  </div></div>
</header>
<main class="wrap">
  <section id="top">
    <div class="top">
      <div class="card"><div class="head"><div>ã¯ã˜ã‚ã«</div></div><div class="body">
        <h2 style="margin:0 0 6px;">æœˆåˆã‹ã‚‰æœˆæœ«ã¾ã§ã€å®Ÿå‹™ã®çµŒç†ã‚’ä½“é¨“ã—ã‚ˆã†ã€‚</h2>
        <p class="muted">freeeçš„UIã§ã€ã‚¹ãƒˆãƒ¼ãƒªãƒ¼â†’å•é¡Œâ†’å³æ™‚è§£èª¬ã€‚æœªçµŒé¨“ã‹ã‚‰ã€Œè§¦ã‚Œã‚‹å®Ÿå‹™ã€ã¾ã§æœ€çŸ­ã§ã€‚</p>
        <div class="row" style="margin:10px 0 16px;">
          <button class="btn primary" onclick="startFromBeginning()">æœˆåˆã‹ã‚‰å§‹ã‚ã‚‹</button>
          <button class="btn" onclick="openDays()">Dayä¸€è¦§ã‚’è¦‹ã‚‹</button>
        </div>
        <div class="navdays" id="nav_days"></div>
      </div></div>
      <div class="card center"><div class="head"><div>ã‚¤ãƒ¡ãƒ¼ã‚¸</div></div><div class="body">
        <svg viewBox="0 0 420 260" xmlns="http://www.w3.org/2000/svg">
          <defs><linearGradient id="gTop" x1="0" x2="1"><stop offset="0" stop-color="#3bb3df"/><stop offset="1" stop-color="#12b4a6"/></linearGradient></defs>
          <rect x="0" y="0" width="420" height="260" rx="18" fill="#f2fbff"/>
          <circle cx="70" cy="70" r="40" fill="url(#gTop)" opacity="0.25"/>
          <circle cx="340" cy="190" r="28" fill="url(#gTop)" opacity="0.25"/>
          <rect x="30" y="180" width="360" height="40" rx="8" fill="#e6f7f5" stroke="#d0eeea"/>
          <rect x="120" y="120" width="180" height="60" rx="8" fill="#fff" stroke="#e2e8f0"/>
          <rect x="135" y="135" width="150" height="12" rx="6" fill="#3bb3df" opacity="0.6"/>
          <rect x="135" y="155" width="120" height="8" rx="4" fill="#cfeff7"/>
          <circle cx="80" cy="140" r="16" fill="#3bb3df" opacity="0.85"/>
          <rect x="70" y="154" width="20" height="24" rx="6" fill="#a3dbf0"/>
          <rect x="320" y="40" width="70" height="90" rx="10" fill="#f0fff9" stroke="#d1fae5"/>
          <path d="M335 95 L355 75 L375 95" stroke="#10b981" stroke-width="6" fill="none" stroke-linecap="round"/>
        </svg>
        <div class="muted" style="margin-top:8px;">â€» SVGã‚¤ãƒ©ã‚¹ãƒˆå†…è£½</div>
      </div></div>
    </div>
    <div class="footer">ä¿å­˜ã¯ç«¯æœ«å†…ï¼ˆlocalStorageï¼‰ã€‚ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ã§å­¦ã¹ã¾ã™ã€‚</div>
  </section>
  <section id="lesson" style="display:none;">
    <div class="card"><div class="head"><div id="day_title">Day 1</div><div class="pill mono" id="day_idx">1 / 10</div></div>
      <div class="body"><div class="scene">
        <div><svg id="day_svg" viewBox="0 0 420 220" xmlns="http://www.w3.org/2000/svg"></svg></div>
        <div><p id="s1" class="muted">â€”</p><p id="s2" class="muted">â€”</p><p id="s3" class="muted">â€”</p>
          <div class="row" style="margin-top:10px;">
            <button class="btn" onclick="backToTop()">ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</button>
            <button class="btn primary" onclick="focusEntry()">ä»•è¨³ã«é€²ã‚€</button></div>
        </div></div></div></div>
    <div class="grid two" style="margin-top:12px;">
      <div class="card"><div class="head"><div>ä»•è¨³å…¥åŠ›ï¼ˆfreeeé¢¨UIï¼‰</div></div>
        <div class="body"><div class="grid" style="grid-template-columns:1fr 1fr; gap:10px;">
          <div><label>å€Ÿæ–¹ç§‘ç›®</label>
            <select id="d_k"><option>å£²æ›é‡‘</option><option>å½“åº§é é‡‘</option><option>æ™®é€šé é‡‘</option><option>ç¾é‡‘</option><option>é€šä¿¡è²»</option><option>æ—…è²»äº¤é€šè²»</option><option>å‰æ‰•è²»ç”¨</option><option>æ¸›ä¾¡å„Ÿå´è²»</option><option>ä»®æ‰•é‡‘</option><option>æ¶ˆè€—å“è²»</option><option>æ³•äººç¨ç­‰</option></select></div>
          <div><label>å€Ÿæ–¹é‡‘é¡</label><input id="d_a" placeholder="110000"></div>
          <div><label>è²¸æ–¹ç§‘ç›®</label>
            <select id="c_k"><option>å£²ä¸Šé«˜</option><option>ä»®å—æ¶ˆè²»ç¨</option><option>å£²æ›é‡‘</option><option>æœªæ‰•è²»ç”¨</option><option>æœªæ‰•é‡‘</option><option>æ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡</option><option>å‰å—é‡‘</option><option>æ™®é€šé é‡‘</option><option>å½“åº§é é‡‘</option><option>ç¾é‡‘</option><option>ä»®æ‰•é‡‘</option><option>æœªæ‰•æ³•äººç¨ç­‰</option><option>ç«‹æ›¿é‡‘</option></select></div>
          <div><label>è²¸æ–¹é‡‘é¡</label><input id="c_a" placeholder="100000"></div>
          <div style="grid-column:1 / -1;"><label>ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label><input id="memo" placeholder="ä¾‹ï¼šBç¤¾ 4æœˆç´å“åˆ† è«‹æ±‚æ›¸No.1234"></div>
        </div>
        <div class="row" style="margin-top:12px; justify-content:space-between;">
          <div id="msg" class="muted"></div>
          <div class="row"><button class="btn" onclick="skipDay()">ã‚¹ã‚­ãƒƒãƒ—</button><button class="btn primary" onclick="grade()">æ¡ç‚¹</button></div>
        </div></div></div>
      <div class="card"><div class="head"><div>ãƒŸãƒ‹ã‚¯ã‚¤ã‚ºï¼ˆé¸æŠå¼ï¼‰</div><div class="pill">ç†è§£ãƒã‚§ãƒƒã‚¯</div></div><div class="body"><div id="mcq_box"></div></div></div>
      <div class="card" style="grid-column:1 / -1;"><div class="head"><div>è§£èª¬ï¼ˆå›³è§£ãƒ»å‹•ãçŸ¢å°ï¼‰</div></div><div class="body"><div id="explain" class="diagram"></div></div></div>
    </div>
    <div class="row" style="margin-top:10px; justify-content:flex-end;"><button class="btn" onclick="openDays()">Dayä¸€è¦§ã¸</button><button class="btn primary" id="next_btn" onclick="nextDay()" disabled>æ¬¡ã®æ—¥ã¸</button></div>
  </section>
  <section id="days" style="display:none; margin-top:10px;">
    <div class="card"><div class="head"><div>Dayä¸€è¦§ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ç§»å‹•ï¼‰</div></div><div class="body"><div class="navdays" id="days_list"></div></div></div>
  </section>
</main>
<canvas id="confetti"></canvas>
<div id="reward" class="modal"><div class="box"><div class="medal"></div><h3 id="tierTitle" style="margin:6px 0 4px;">ã‚¯ãƒªã‚¢ï¼</h3><div class="muted" id="tierDesc">ä»Šæ—¥ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’é”æˆã€‚æ¬¡ã®æ—¥ã¸é€²ã‚‚ã†ï¼</div><div class="row" style="justify-content:center; margin-top:10px;"><button class="btn" onclick="closeReward()">é–‰ã˜ã‚‹</button><button class="btn primary" onclick="nextDay(); closeReward()">æ¬¡ã®æ—¥ã¸</button></div></div></div>
<div id="toast" class="toast">ä¿å­˜ã—ã¾ã—ãŸã€‚</div>
<script>
/* DAYS, sceneSVG, explainSVG, logic â€” identical to MVP beta from earlier message (abbreviated here for brevity) */
const DAYS=[
{id:'d1',title:'Day1ï¼ˆæœˆåˆï¼‰è«‹æ±‚ã®è¨ˆä¸Š',scene:['æœˆåˆã€å…ˆæœˆç´å“åˆ†ã®è«‹æ±‚æ›¸ã‚’ç™ºè¡Œã—ã¾ã™ã€‚','Bç¤¾ã¸ç¨æŠœ100,000å††ï¼ˆæ¶ˆè²»ç¨10%ï¼‰ã€‚','å£²æ›é‡‘ã‚’è¨ˆä¸Šã—ã¾ã—ã‚‡ã†ã€‚'],point:'å£²æ›é‡‘ã®è¨ˆä¸Šï¼ˆå¤–ç¨/å†…ç¨OKï¼‰',hint:'å€Ÿæ–¹ï¼šå£²æ›é‡‘ 110,000 / è²¸æ–¹ï¼šå£²ä¸Šé«˜ 100,000, ä»®å—æ¶ˆè²»ç¨ 10,000ï¼ˆå†…ç¨ã¯å£²ä¸Šé«˜110,000ã§ã‚‚OKï¼‰',expects:[{dK:'å£²æ›é‡‘',dA:110000,cK:'å£²ä¸Šé«˜',cA:100000,altK:'ä»®å—æ¶ˆè²»ç¨',altA:10000,mode:'split'},{dK:'å£²æ›é‡‘',dA:110000,cK:'å£²ä¸Šé«˜',cA:110000,mode:'gross'}],mcq:{q:'ã€Œè«‹æ±‚æ›¸ç™ºè¡Œæ™‚ã€ã®æ­£ã—ã„å‡¦ç†ã¯ï¼Ÿ',choices:['ç¾é‡‘ / å£²ä¸Šé«˜','å£²æ›é‡‘ / å£²ä¸Šé«˜ï¼ˆ+ä»®å—æ¶ˆè²»ç¨ï¼‰','å£²ä¸Šé«˜ / å£²æ›é‡‘'],answer:1,why:'å…¥é‡‘å‰ã¯è³‡ç”£ï¼ˆå£²æ›é‡‘ï¼‰ãŒå¢—ãˆã‚‹ã€‚'},svg:'invoice',confetti:120},
{id:'d2',title:'Day2 å…¥é‡‘ã®æ¶ˆè¾¼',scene:['Bç¤¾ã‹ã‚‰ã®å…¥é‡‘110,000å††ãŒå½“åº§ã«å…¥ã‚Šã¾ã—ãŸã€‚','æ‰‹æ•°æ–™ãªã—ã€‚','å£²æ›é‡‘ã‚’æ¶ˆã—è¾¼ã¿ã¾ã—ã‚‡ã†ã€‚'],point:'é é‡‘å¢— / å£²æ›é‡‘æ¸›',hint:'å€Ÿæ–¹ï¼šå½“åº§/æ™®é€š/ç¾é‡‘ 110,000 / è²¸æ–¹ï¼šå£²æ›é‡‘ 110,000',expects:[{dKAny:['å½“åº§é é‡‘','æ™®é€šé é‡‘','ç¾é‡‘'],dA:110000,cK:'å£²æ›é‡‘',cA:110000}],mcq:{q:'å£²æ›é‡‘ã®æ¶ˆè¾¼ã§æ­£ã—ã„ã®ã¯ï¼Ÿ',choices:['å£²æ›é‡‘ / ç¾é‡‘','æ™®é€šé é‡‘ / å£²æ›é‡‘','å£²ä¸Šé«˜ / æ™®é€šé é‡‘'],answer:1,why:'å…¥é‡‘ã§é é‡‘ãŒå¢—ãˆã€å£²æ›é‡‘ãŒæ¸›ã‚‹ã€‚'},svg:'bank',confetti:130},
{id:'d3',title:'Day3 çµŒè²»ã®æœªæ‰•è¨ˆä¸Š',scene:['4æœˆåˆ†é€šä¿¡è²»22,000å††ã®è«‹æ±‚æ›¸æœªç€ã€‚','ç™ºç”Ÿä¸»ç¾©ã§å½“æœˆã«è²»ç”¨è¨ˆä¸Šã€‚','æœªæ‰•è²»ç”¨ã§è¨ˆä¸Šã—ã¾ã™ã€‚'],point:'è²»ç”¨ / æœªæ‰•è²»ç”¨',hint:'å€Ÿæ–¹ï¼šé€šä¿¡è²» 22,000 / è²¸æ–¹ï¼šæœªæ‰•è²»ç”¨ 22,000',expects:[{dK:'é€šä¿¡è²»',dA:22000,cK:'æœªæ‰•è²»ç”¨',cA:22000}],mcq:{q:'ã€Œè«‹æ±‚æ›¸æœªç€ã€ã®æ™‚ã€é©åˆ‡ãªã®ã¯ï¼Ÿ',choices:['è²»ç”¨ / ç¾é‡‘','æœªæ‰•é‡‘ / è²»ç”¨','è²»ç”¨ / æœªæ‰•è²»ç”¨'],answer:2,why:'ç™ºç”Ÿä¸»ç¾©ã€‚å¯¾ä¾¡æœªæ‰•ã„ã¯è² å‚µã§è¨ˆä¸Šã€‚'},svg:'expense',confetti:140},
{id:'d4',title:'Day4 å‰æ‰•è²»ç”¨ã®è¨ˆä¸Š',scene:['SaaSå¹´é¡132,000å††ã‚’å…ˆæ‰•ã„ï¼ˆ5/1ã€œç¿Œ4/30ï¼‰ã€‚','æä¾›å‰ã¯è³‡ç”£ï¼ˆå‰æ‰•è²»ç”¨ï¼‰ã€‚','æ”¯æ‰•ã¯æ™®é€šé é‡‘ã‹ã‚‰ã€‚'],point:'å‰æ‰•è²»ç”¨ / é é‡‘',hint:'å€Ÿæ–¹ï¼šå‰æ‰•è²»ç”¨ 132,000 / è²¸æ–¹ï¼šæ™®é€šé é‡‘ï¼ˆå½“åº§ï¼‰ 132,000',expects:[{dK:'å‰æ‰•è²»ç”¨',dA:132000,cKAny:['æ™®é€šé é‡‘','å½“åº§é é‡‘','ç¾é‡‘'],cA:132000}],mcq:{q:'æä¾›å‰ã®å¯¾ä¾¡ã¯ï¼Ÿ',choices:['è²»ç”¨','è³‡ç”£ï¼ˆå‰æ‰•è²»ç”¨ï¼‰','è² å‚µ'],answer:1,why:'æœªæ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã®æ¨©åˆ©ã¯è³‡ç”£ã€‚'},svg:'prepaid',confetti:150},
{id:'d5',title:'Day5 æœˆæœ«ã®æ¸›ä¾¡å„Ÿå´',scene:['å‚™å“200,000å††ã€è€ç”¨å¹´æ•°5å¹´ï¼ˆå®šé¡æ³•ï¼‰ã€‚','æœˆæœ«ã«å„Ÿå´ã€‚','æœˆé¡â‰ˆ3,333å††ï¼ˆç«¯æ•°Â±1è¨±å®¹ï¼‰ã€‚'],point:'æ¸›ä¾¡å„Ÿå´è²» / æ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡',hint:'å€Ÿæ–¹ï¼šæ¸›ä¾¡å„Ÿå´è²» 3,333 / è²¸æ–¹ï¼šæ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡ 3,333',expects:[{dK:'æ¸›ä¾¡å„Ÿå´è²»',dAAny:[3333,3334],cK:'æ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡',cAAny:[3333,3334]}],mcq:{q:'æ¸›ä¾¡å„Ÿå´ã®ç›¸æ‰‹å‹˜å®šã¯ï¼Ÿ',choices:['æ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡','å›ºå®šè³‡ç”£','ç¾é‡‘'],answer:0,why:'ç´¯è¨ˆé¡ã§è³‡ç”£ä¾¡å€¤ã®æ¸›å°‘ã‚’é–“æ¥è¡¨ç¤ºã€‚'},svg:'depr',confetti:170},
{id:'d6',title:'Day6 ä»®æ‰•é‡‘ã®ç²¾ç®—ï¼ˆæ—…è²»ï¼‰',scene:['å‡ºå¼µä»®æ‰•15,000å††ã‚’ç²¾ç®—ã€‚','é ˜åæ›¸ã‚ã‚Šã€å·®é¡ãªã—ã€‚','æ—…è²»äº¤é€šè²»ã§ç²¾ç®—ã€‚'],point:'æ—…è²»äº¤é€šè²» / ä»®æ‰•é‡‘',hint:'å€Ÿæ–¹ï¼šæ—…è²»äº¤é€šè²» 15,000 / è²¸æ–¹ï¼šä»®æ‰•é‡‘ 15,000',expects:[{dK:'æ—…è²»äº¤é€šè²»',dA:15000,cK:'ä»®æ‰•é‡‘',cA:15000}],mcq:{q:'ä»®æ‰•ã®ç²¾ç®—ã§æ­£ã—ã„ã®ã¯ï¼Ÿ',choices:['ä»®æ‰•é‡‘ / æ—…è²»äº¤é€šè²»','æ—…è²»äº¤é€šè²» / ä»®æ‰•é‡‘','ç¾é‡‘ / ä»®æ‰•é‡‘'],answer:1,why:'è²»ç”¨ã‚’è¨ˆä¸Šã—ã€ä»®æ‰•ã‚’æ¶ˆã™ã€‚'},svg:'travel',confetti:180},
{id:'d7',title:'Day7 å£²ä¸Šè¨ˆä¸Šæ¼ã‚Œã®ä¿®æ­£',scene:['ç¨æŠœ50,000ã®è¨ˆä¸Šæ¼ã‚ŒãŒåˆ¤æ˜ã€‚','æ¶ˆè²»ç¨10%ã€‚','å½“æœˆå£²æ›ã§è¿½åŠ è¨ˆä¸Šã€‚'],point:'å£²æ›é‡‘è¿½åŠ ï¼ˆå¤–ç¨/å†…ç¨OKï¼‰',hint:'å€Ÿæ–¹ï¼šå£²æ›é‡‘ 55,000 / è²¸æ–¹ï¼šå£²ä¸Šé«˜ 50,000, ä»®å—æ¶ˆè²»ç¨ 5,000ï¼ˆã¾ãŸã¯å£²ä¸Šé«˜55,000ï¼‰',expects:[{dK:'å£²æ›é‡‘',dA:55000,cK:'å£²ä¸Šé«˜',cA:50000,altK:'ä»®å—æ¶ˆè²»ç¨',altA:5000,mode:'split'},{dK:'å£²æ›é‡‘',dA:55000,cK:'å£²ä¸Šé«˜',cA:55000,mode:'gross'}],mcq:{q:'å£²ä¸Šã®è¨ˆä¸Šæ¼ã‚Œå¯¾å¿œã¯ï¼Ÿ',choices:['å…¥é‡‘ / å£²ä¸Šé«˜','å£²æ›é‡‘ / å£²ä¸Šé«˜ï¼ˆ+ä»®å—ï¼‰','å£²ä¸Šé«˜ / å£²æ›é‡‘'],answer:1,why:'æœªåã®ãŸã‚å£²æ›ã€‚'},svg:'close',confetti:190},
{id:'d8',title:'Day8 å‰å—é‡‘ã®å‡¦ç†',scene:['é•·æœŸå¥‘ç´„ã®å‰å—ã§66,000å††ã‚’å—é ˜ï¼ˆå†…ç¨ï¼‰ã€‚','æä¾›å‰ãªã®ã§è² å‚µã€‚','é é‡‘ã§å—é ˜ã€‚'],point:'é é‡‘ / å‰å—é‡‘',hint:'å€Ÿæ–¹ï¼šå½“åº§/æ™®é€š/ç¾é‡‘ 66,000 / è²¸æ–¹ï¼šå‰å—é‡‘ 66,000',expects:[{dKAny:['å½“åº§é é‡‘','æ™®é€šé é‡‘','ç¾é‡‘'],dA:66000,cK:'å‰å—é‡‘',cA:66000}],mcq:{q:'æä¾›å‰ã®å—é ˜ã¯ï¼Ÿ',choices:['å£²ä¸Šé«˜','å‰å—é‡‘','é›‘åå…¥'],answer:1,why:'ã¾ã æä¾›ã—ã¦ã„ãªã„ãŸã‚åç›Šã§ã¯ãªã„ã€‚'},svg:'advance',confetti:200},
{id:'d9',title:'Day9 ç«‹æ›¿é‡‘ã®ç²¾ç®—',scene:['ç·å‹™ãŒç«‹æ›¿ãˆãŸå‚™å“ä»£8,800å††ã‚’ç²¾ç®—ã€‚','æ¶ˆè€—å“è²»ã§å‡¦ç†ã€‚','ç«‹æ›¿é‡‘ã®æ¶ˆã—è¾¼ã¿ã€‚'],point:'æ¶ˆè€—å“è²» / ç«‹æ›¿é‡‘',hint:'å€Ÿæ–¹ï¼šæ¶ˆè€—å“è²» 8,800 / è²¸æ–¹ï¼šç«‹æ›¿é‡‘ 8,800',expects:[{dK:'æ¶ˆè€—å“è²»',dA:8800,cK:'ç«‹æ›¿é‡‘',cA:8800}],mcq:{q:'å¾“æ¥­å“¡ç«‹æ›¿ã®ç²¾ç®—ã§ç›¸æ‰‹ã¯ï¼Ÿ',choices:['æœªæ‰•è²»ç”¨','ç«‹æ›¿é‡‘','ä»®å—é‡‘'],answer:1,why:'å¾“æ¥­å“¡ã«å¯¾ã™ã‚‹å‚µå‹™ï¼ˆç«‹æ›¿é‡‘ï¼‰ã‚’æ¶ˆã™ã€‚'},svg:'petty',confetti:210},
{id:'d10',title:'Day10 æ³•äººç¨ç­‰ã®ä»®è¨ˆä¸Š',scene:['æ±ºç®—è¦‹è¾¼ã¿ã§æ³•äººç¨ç­‰100,000å††ã‚’ä»®è¨ˆä¸Šã€‚','ç´ä»˜ã¯å¾Œæ—¥ã€‚','è² å‚µã§è¨ˆä¸Šã€‚'],point:'æ³•äººç¨ç­‰ / æœªæ‰•æ³•äººç¨ç­‰',hint:'å€Ÿæ–¹ï¼šæ³•äººç¨ç­‰ 100,000 / è²¸æ–¹ï¼šæœªæ‰•æ³•äººç¨ç­‰ 100,000',expects:[{dK:'æ³•äººç¨ç­‰',dA:100000,cK:'æœªæ‰•æ³•äººç¨ç­‰',cA:100000}],mcq:{q:'ç¨é‡‘ã®ä»®è¨ˆä¸Šã¯ï¼Ÿ',choices:['æ³•äººç¨ç­‰ / ç¾é‡‘','æœªæ‰•æ³•äººç¨ç­‰ / æ³•äººç¨ç­‰','æ³•äººç¨ç­‰ / æœªæ‰•æ³•äººç¨ç­‰'],answer:2,why:'æ”¯æ‰•ã„å‰ã¯è² å‚µè¨ˆä¸Šã€‚'},svg:'tax',confetti:230}
];
function sceneSVG(key){const base=(a)=>`<rect x="0" y="0" width="420" height="220" rx="16" fill="#fff" stroke="#e2e8f0"/><circle cx="360" cy="50" r="20" fill="${a}" opacity="0.25"/><circle cx="50" cy="180" r="18" fill="${a}" opacity="0.25"/>`;const s={invoice:`<g>${base('#3bb3df')}<rect x="30" y="26" width="120" height="18" rx="9" fill="#3bb3df" opacity=".9"/><rect x="30" y="60" width="180" height="10" rx="5" fill="#cfeff7"/><rect x="30" y="78" width="200" height="10" rx="5" fill="#e6f7f5"/><rect x="30" y="110" width="360" height="80" rx="10" fill="#f7fbff" stroke="#e2e8f0"/><rect x="60" y="130" width="120" height="12" rx="6" fill="#12b4a6" opacity=".7"/><rect x="60" y="150" width="200" height="12" rx="6" fill="#cfeff7"/></g>`,bank:`<g>${base('#12b4a6')}<rect x="40" y="30" width="100" height="60" rx="10" fill="#f0fff9" stroke="#d1fae5"/><path d="M56 66 L85 45 L108 70" stroke="#10b981" stroke-width="6" fill="none" stroke-linecap="round"/><rect x="170" y="30" width="220" height="30" rx="8" fill="#e6f7f5" stroke="#d0eeea"/><rect x="170" y="70" width="160" height="10" rx="5" fill="#cfeff7"/><rect x="170" y="90" width="190" height="10" rx="5" fill="#e6f7f5"/></g>`,expense:`<g>${base('#3bb3df')}<rect x="40" y="30" width="80" height="80" rx="12" fill="#fff" stroke="#e2e8f0"/><rect x="60" y="46" width="40" height="10" rx="5" fill="#3bb3df"/><rect x="180" y="40" width="200" height="18" rx="9" fill="#e6f7f5"/><rect x="180" y="70" width="160" height="10" rx="5" fill="#cfeff7"/><rect x="180" y="88" width="140" height="10" rx="5" fill="#e6f7f5"/></g>`,prepaid:`<g>${base('#12b4a6')}<rect x="40" y="30" width="140" height="40" rx="10" fill="#12b4a6" opacity=".85"/><rect x="200" y="30" width="180" height="40" rx="10" fill="#a3dbf0"/><rect x="40" y="90" width="340" height="20" rx="10" fill="#e6f7f5"/><rect x="40" y="120" width="260" height="10" rx="5" fill="#cfeff7"/></g>`,depr:`<g>${base('#3bb3df')}<rect x="40" y="30" width="340" height="30" rx="8" fill="#f0fff9" stroke="#d1fae5"/><rect x="60" y="40" width="120" height="12" rx="6" fill="#10b981"/><rect x="200" y="40" width="120" height="12" rx="6" fill="#a7f3d0"/><rect x="60" y="90" width="300" height="12" rx="6" fill="#cfeff7"/><rect x="60" y="110" width="220" height="12" rx="6" fill="#e6f7f5"/></g>`,travel:`<g>${base('#3bb3df')}<rect x="30" y="30" width="120" height="80" rx="12" fill="#fff" stroke="#e2e8f0"/><circle cx="90" cy="70" r="22" fill="#3bb3df" opacity=".85"/><rect x="180" y="30" width="200" height="18" rx="9" fill="#e6f7f5"/><rect x="180" y="60" width="160" height="10" rx="5" fill="#cfeff7"/><rect x="180" y="78" width="140" height="10" rx="5" fill="#e6f7f5"/></g>`,close:`<g>${base('#12b4a6')}<rect x="40" y="30" width="80" height="80" rx="12" fill="#f0fff9" stroke="#d1fae5"/><path d="M56 82 L85 55 L108 86" stroke="#10b981" stroke-width="6" fill="none" stroke-linecap="round"/><rect x="150" y="30" width="230" height="30" rx="8" fill="#e6f7f5"/><rect x="150" y="70" width="200" height="10" rx="5" fill="#cfeff7"/><rect x="150" y="90" width="160" height="10" rx="5" fill="#e6f7f5"/></g>`,advance:`<g>${base('#12b4a6')}<rect x="40" y="30" width="100" height="60" rx="10" fill="#f0fff9" stroke="#d1fae5"/><path d="M56 66 L85 45 L108 70" stroke="#10b981" stroke-width="6" fill="none" stroke-linecap="round"/><rect x="170" y="30" width="220" height="30" rx="8" fill="#e6f7f5" stroke="#d0eeea"/><rect x="170" y="70" width="160" height="10" rx="5" fill="#cfeff7"/><rect x="170" y="90" width="190" height="10" rx="5" fill="#e6f7f5"/></g>`,petty:`<g>${base('#3bb3df')}<rect x="40" y="30" width="100" height="60" rx="10" fill="#fff" stroke="#e2e8f0"/><rect x="60" y="46" width="60" height="10" rx="5" fill="#3bb3df"/><rect x="170" y="30" width="220" height="30" rx="8" fill="#e6f7f5" stroke="#d0eeea"/><rect x="170" y="70" width="160" height="10" rx="5" fill="#cfeff7"/><rect x="170" y="90" width="190" height="10" rx="5" fill="#e6f7f5"/></g>`,tax:`<g>${base('#3bb3df')}<rect x="40" y="30" width="80" height="80" rx="12" fill="#f0fff9" stroke="#d1fae5"/><rect x="150" y="30" width="230" height="30" rx="8" fill="#e6f7f5"/><rect x="150" y="70" width="200" height="10" rx="5" fill="#cfeff7"/><rect x="150" y="90" width="160" height="10" rx="5" fill="#e6f7f5"/></g>`};return s[key]||''}
function explainSVG(day){const a='<path class="arrow" d="M0 0 L60 0" />';if(day.id==='d1'||day.id==='d7'){return `<svg viewBox="0 0 560 190" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="190" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">å£²æ›é‡‘ã®è¨ˆä¸Šï¼ˆTå­—å‹˜å®šï¼‰</text><rect x="20" y="40" width="230" height="120" rx="10" fill="#f8feff" stroke="#cfeff7"/><rect x="310" y="40" width="230" height="120" rx="10" fill="#f8feff" stroke="#cfeff7"/><text x="30" y="58" fill="#0f172a" font-size="12">å€Ÿæ–¹ï¼šå£²æ›é‡‘</text><text x="320" y="58" fill="#0f172a" font-size="12">è²¸æ–¹ï¼šå£²ä¸Šé«˜ / ä»®å—æ¶ˆè²»ç¨</text><line x1="30" y1="70" x2="240" y2="70" stroke="#e2e8f0"/><line x1="320" y1="70" x2="530" y2="70" stroke="#e2e8f0"/><text x="40" y="98" fill="#12b4a6" font-size="20" font-weight="800">110,000</text><text x="330" y="98" fill="#3bb3df" font-size="16" font-weight="700">100,000</text><text x="330" y="122" fill="#3bb3df" font-size="16" font-weight="700">10,000</text><text x="330" y="148" fill="#64748b" font-size="11">ï¼ˆå†…ç¨ãªã‚‰è²¸æ–¹ã¯å£²ä¸Šé«˜ 110,000ï¼‰</text><g transform="translate(255,100)"><g transform="translate(0,0)">${a}<polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g></g></svg>`} if(day.id==='d2'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">å…¥é‡‘æ¶ˆè¾¼ã®æµã‚Œ</text><rect x="30" y="60" width="120" height="40" rx="10" fill="#e6f7f5" stroke="#cfeff7"/><text x="52" y="85" fill="#0a5e57" font-size="12">éŠ€è¡Œå…¥é‡‘</text><g transform="translate(150,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="220" y="60" width="120" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="235" y="85" fill="#059669" font-size="12">é é‡‘ã®å¢—åŠ </text><g transform="translate(340,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="410" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="432" y="85" fill="#334155" font-size="12">å£²æ›é‡‘æ¶ˆè¾¼</text></svg>`} if(day.id==='d3'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">æœªæ‰•è¨ˆä¸Šï¼ˆç™ºç”Ÿä¸»ç¾©ï¼‰</text><rect x="30" y="60" width="160" height="40" rx="10" fill="#f8feff" stroke="#cfeff7"/><text x="40" y="85" fill="#0a5e57" font-size="12">4æœˆã«è²»ç”¨ãŒç™ºç”Ÿ</text><g transform="translate(190,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="260" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="268" y="85" fill="#334155" font-size="12">é€šä¿¡è²»</text><g transform="translate(380,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="450" y="60" width="80" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="458" y="85" fill="#059669" font-size="12">æœªæ‰•</text></svg>`} if(day.id==='d4'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">å‰æ‰•è²»ç”¨ã®æµã‚Œ</text><rect x="30" y="60" width="120" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="44" y="85" fill="#059669" font-size="12">æ”¯æ‰•</text><g transform="translate(150,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="220" y="60" width="120" height="40" rx="10" fill="#e6f7f5" stroke="#cfeff7"/><text x="234" y="85" fill="#0a5e57" font-size="12">å‰æ‰•è²»ç”¨</text><g transform="translate(340,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="410" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="432" y="85" fill="#334155" font-size="12">è²»ç”¨åŒ–</text></svg>`} if(day.id==='d5'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">æ¸›ä¾¡å„Ÿå´ã®ã‚¤ãƒ¡ãƒ¼ã‚¸</text><rect x="30" y="60" width="120" height="40" rx="10" fill="#f8feff" stroke="#cfeff7"/><text x="50" y="85" fill="#0a5e57" font-size="12">å›ºå®šè³‡ç”£</text><g transform="translate(150,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="220" y="60" width="140" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="230" y="85" fill="#334155" font-size="12">æ¸›ä¾¡å„Ÿå´è²»</text><g transform="translate(360,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="430" y="60" width="100" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="438" y="85" fill="#059669" font-size="12">ç´¯è¨ˆé¡</text></svg>`} if(day.id==='d6'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">ä»®æ‰•â†’ç²¾ç®—ã®æµã‚Œ</text><rect x="30" y="60" width="120" height="40" rx="10" fill="#e6f7f5" stroke="#cfeff7"/><text x="60" y="85" fill="#0a5e57" font-size="12">ä»®æ‰•</text><g transform="translate(150,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="220" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="228" y="85" fill="#334155" font-size="12">æ—…è²»äº¤é€šè²»</text><g transform="translate(340,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="410" y="60" width="120" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="438" y="85" fill="#059669" font-size="12">ç²¾ç®—</text></svg>`} if(day.id==='d8'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">å‰å—é‡‘ï¼ˆå—é ˜â†’è² å‚µï¼‰</text><rect x="30" y="60" width="120" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="50" y="85" fill="#059669" font-size="12">å…¥é‡‘</text><g transform="translate(150,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="220" y="60" width="120" height="40" rx="10" fill="#e6f7f5" stroke="#cfeff7"/><text x="240" y="85" fill="#0a5e57" font-size="12">å‰å—é‡‘</text><g transform="translate(340,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="410" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="438" y="85" fill="#334155" font-size="12">æä¾›å¾Œã«åç›ŠåŒ–</text></svg>`} if(day.id==='d9'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">ç«‹æ›¿é‡‘ã®ç²¾ç®—</text><rect x="30" y="60" width="140" height="40" rx="10" fill="#e6f7f5" stroke="#cfeff7"/><text x="56" y="85" fill="#0a5e57" font-size="12">ç«‹æ›¿é‡‘ï¼ˆå¾“æ¥­å“¡ï¼‰</text><g transform="translate(170,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="240" y="60" width="120" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="258" y="85" fill="#334155" font-size="12">æ¶ˆè€—å“è²»</text><g transform="translate(360,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="430" y="60" width="100" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="442" y="85" fill="#059669" font-size="12">ç²¾ç®—</text></svg>`} if(day.id==='d10'){return `<svg viewBox="0 0 560 170" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="560" height="170" rx="14" fill="#fff" stroke="#e2e8f0"/><text x="20" y="24" fill="#0f172a" font-size="14" font-weight="700">æ³•äººç¨ç­‰ã®ä»®è¨ˆä¸Š</text><rect x="30" y="60" width="200" height="40" rx="10" fill="#f8feff" stroke="#cfeff7"/><text x="50" y="85" fill="#0a5e57" font-size="12">ç¨é¡è¦‹è¾¼ã¿</text><g transform="translate(230,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="300" y="60" width="100" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/><text x="310" y="85" fill="#334155" font-size="12">æ³•äººç¨ç­‰</text><g transform="translate(400,80)"><path class="arrow" d="M0 0 L60 0"/><polygon points="60,-4 70,0 60,4" fill="#12b4a6"/></g><rect x="470" y="60" width="60" height="40" rx="10" fill="#f0fff9" stroke="#d1fae5"/><text x="478" y="85" fill="#059669" font-size="12">æœªæ‰•</text></svg>`} return ''}
let idx=0;let progress=JSON.parse(localStorage.getItem('keiri_progress_mvp')||'{"done":0,"total":'+DAYS.length+'}');let attempts=0;let startTime=0;
function updateBar(){const p=Math.round((progress.done/Math.max(1,progress.total))*100);document.getElementById('bar').style.width=p+'%';document.getElementById('pct').textContent=p+'%';document.getElementById('remain').textContent='æ®‹ã‚Š '+Math.max(0,DAYS.length-progress.done)+'æ—¥'}
function showToast(t){const el=document.getElementById('toast');el.textContent=t;el.style.display='block';setTimeout(()=>el.style.display='none',1500)}
function startFromBeginning(){idx=0;openLesson(idx)}function openDays(){document.getElementById('top').style.display='none';document.getElementById('lesson').style.display='none';document.getElementById('days').style.display='block';buildDays()}function backToTop(){document.getElementById('top').style.display='block';document.getElementById('lesson').style.display='none';document.getElementById('days').style.display='none'}function buildDays(){const host=document.getElementById('days_list');host.innerHTML='';DAYS.forEach((d,i)=>{const b=document.createElement('button');b.className='btn';b.textContent=(i+1)+'. '+d.title;b.onclick=()=>openLesson(i);host.appendChild(b)})}(function buildNav(){const host=document.getElementById('nav_days');host.innerHTML='';DAYS.forEach((d,i)=>{const b=document.createElement('button');b.className='btn';b.textContent='Day'+(i+1);b.onclick=()=>openLesson(i);host.appendChild(b)})})();
function openLesson(i){idx=i;attempts=0;startTime=performance.now();const d=DAYS[i];document.getElementById('top').style.display='none';document.getElementById('lesson').style.display='block';document.getElementById('days').style.display='none';day_title.textContent=d.title;day_idx.textContent=(i+1)+' / '+DAYS.length;s1.textContent=d.scene[0]||'';s2.textContent=d.scene[1]||'';s3.textContent=d.scene[2]||'';day_svg.innerHTML=sceneSVG(d.svg);explain.innerHTML=explainSVG(d);renderMCQ(d.mcq);d_k.value='å£²æ›é‡‘';d_a.value='';c_k.value='å£²ä¸Šé«˜';c_a.value='';memo.value='';msg.textContent='ã“ã®æ—¥ã®å–å¼•ã®ä»•è¨³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';next_btn.disabled=true;window.scrollTo({top:0,behavior:'smooth'})}
function focusEntry(){d_k.focus()}function renderMCQ(mcq){const box=document.getElementById('mcq_box');box.innerHTML='';const q=document.createElement('div');q.textContent=mcq.q;q.style.marginBottom='8px';box.appendChild(q);mcq.choices.forEach((c,ix)=>{const id='mc_'+Math.random().toString(36).slice(2);const w=document.createElement('div');w.innerHTML=`<input type="radio" name="mcq" id="${id}"><label for="${id}" style="margin-left:6px;">${c}</label>`;box.appendChild(w);w.querySelector('input').addEventListener('change',()=>{const hint=document.createElement('div');hint.style.marginTop='6px';hint.className='muted mcq_hint';if(ix===mcq.answer){hint.innerHTML='<span class="ok">â— æ­£è§£</span>ï¼š'+mcq.why}else{hint.innerHTML='<span class="ng">Ã— ä¸æ­£è§£</span>ï¼š'+mcq.why}const old=box.querySelector('.mcq_hint');if(old)old.remove();box.appendChild(hint)})})}
function roughlyEqual(a,b){return Math.abs(a-b)<=1}
function grade(){attempts++;const d=DAYS[idx];const dK=d_k.value,dA=Number(d_a.value),cK=c_k.value,cA=Number(c_a.value);let ok=false;for(const ex of d.expects){const dKOK=ex.dKAny?ex.dKAny.includes(dK):(ex.dK?dK===ex.dK:true);const cKOK=ex.cKAny?ex.cKAny.includes(cK):(ex.cK?cK===ex.cK:true);const dAOK=ex.dAAny?ex.dAAny.some(x=>roughlyEqual(x,dA)):(typeof ex.dA==='number'?dA===ex.dA:true);const cAOK=ex.cAAny?ex.cAAny.some(x=>roughlyEqual(x,cA)):(typeof ex.cA==='number'?cA===ex.cA:true);if(dKOK&&cKOK&&dAOK&&cAOK){ok=true;break}}if(ok){msg.innerHTML='<span class="ok">ğŸ‰ æ­£è§£ï¼</span> '+d.hint;if(progress.done<idx+1){progress.done=idx+1;localStorage.setItem('keiri_progress_mvp',JSON.stringify(progress));updateBar()}next_btn.disabled=false;const elapsed=(performance.now()-startTime)/1000;const tier=medalTier(attempts,elapsed);showMedal(tier);launchConfetti(d.confetti+tierBoost(tier))}else{msg.innerHTML='<span class="ng">âš  ã‚‚ã†ä¸€æ­©ã€‚</span> '+d.hint}}
function skipDay(){next_btn.disabled=false;msg.textContent='ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚æ­£è§£ã¯ï¼š'+DAYS[idx].hint}
function nextDay(){if(idx<DAYS.length-1){openLesson(idx+1)}else{showToast('10æ—¥åˆ†ã€å®Œäº†ï¼ãŠç–²ã‚Œã•ã¾ã§ã—ãŸã€‚');backToTop()}}
function medalTier(attempts,elapsed){if(attempts<=1&&elapsed<45)return'gold';if(attempts<=2&&elapsed<120)return'silver';return'bronze'}
function tierBoost(t){return t==='gold'?80:t==='silver'?40:0}
const confettiCanvas=document.getElementById('confetti');const ctx=confettiCanvas.getContext('2d');function resize(){confettiCanvas.width=window.innerWidth;confettiCanvas.height=window.innerHeight}window.addEventListener('resize',resize);resize();let confetti=[]
function launchConfetti(amount){const colors=['#12b4a6','#3bb3df','#a3dbf0','#10b981','#f59e0b','#ef4444'];confetti=Array.from({length:amount},(_,i)=>{const angle=Math.random()*Math.PI*2;const speed=2+Math.random()*4;return{x:confettiCanvas.width/2,y:0,vx:Math.cos(angle)*speed,vy:Math.sin(angle)*speed,size:6+Math.random()*6,color:colors[i%colors.length],rot:Math.random()*360,vr:(Math.random()-.5)*10,life:0,max:220}});animateConfetti()}
function animateConfetti(){let alive=false;ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);confetti.forEach(p=>{p.life++;p.vy+=.08;p.x+=p.vx;p.y+=p.vy;p.rot+=p.vr;if(p.life<p.max&&p.y<confettiCanvas.height+30){alive=true}ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.rot*Math.PI/180);ctx.fillStyle=p.color;ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);ctx.restore()});if(alive)requestAnimationFrame(animateConfetti);else ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height)}
const reward=document.getElementById('reward'),tierTitle=document.getElementById('tierTitle'),tierDesc=document.getElementById('tierDesc')
function showMedal(t){reward.style.display='flex';let name='GOLD',desc='é€Ÿåº¦ãƒ»æ­£ç¢ºã•ãƒãƒƒãƒãƒªï¼';if(t==='silver'){name='SILVER';desc='å®‰å®šã‚¯ãƒªã‚¢ï¼'}if(t==='bronze'){name='BRONZE';desc='ã¾ãšã¯ã‚¯ãƒªã‚¢ï¼æ¬¡ã¯ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—ã‚’ç‹™ãŠã†'}tierTitle.textContent=name+' MEDAL';tierDesc.textContent=desc}
function closeReward(){reward.style.display='none'}
const day_title=document.getElementById('day_title'),day_idx=document.getElementById('day_idx'),s1=document.getElementById('s1'),s2=document.getElementById('s2'),s3=document.getElementById('s3'),day_svg=document.getElementById('day_svg'),explain=document.getElementById('explain'),d_k=document.getElementById('d_k'),d_a=document.getElementById('d_a'),c_k=document.getElementById('c_k'),c_a=document.getElementById('c_a'),memo=document.getElementById('memo'),msg=document.getElementById('msg'),next_btn=document.getElementById('next_btn'),nav_days=document.getElementById('nav_days'),days_list=document.getElementById('days_list')
function buildDays(){const host=days_list;host.innerHTML='';DAYS.forEach((d,i)=>{const b=document.createElement('button');b.className='btn';b.textContent=(i+1)+'. '+d.title;b.addEventListener('click',()=>openLesson(i));host.appendChild(b)})}
(function init(){updateBar();buildDays();nav_days.innerHTML='';DAYS.forEach((d,i)=>{const b=document.createElement('button');b.className='btn';b.textContent='Day'+(i+1);b.addEventListener('click',()=>openLesson(i));nav_days.appendChild(b)})})();
</script></body></html>
